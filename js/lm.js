class lliiiliii{constructor(){this.iiliililil=14,this.iiliililii=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22],this.iiliiliill=[.25479851061131553,-.3255503118680449,-.6503185377089651,-.28919126444774784,-.04525132144873906,-.002071332116774595],this.iiliiliili=[1,2.076711702373047,1.4606242909763516,.43593529692665967,.054151797245674226,.0021284987017821146,-5.578984132167551e-7],this.iiliiliiil=[.08333333333333333,-.008333333333333333,.003968253968253968,-.004166666666666667,.007575757575757576,-.021092796092796094,.08333333333333333,-.4432598039215686,3.0539543302701198,-26.456212121212122,281.46014492753625,-3607.5105463980462,54827.583333333336,-974936.8238505747,20052695.79668808,-472384867.7216299,12635724795.916666],this.iiliiliiii=.9955816268920898,this.iiliiillll=1.4616321446374059,this.iiliiillli=3.309564688275257e-10,this.iiliiillil=9.016312093258695e-20,this.iiliiillii=2.109325408935547,this.iiliiilill=[-1.1093280605946045,-3.831067447261932,-3.3703848401898284,.2808057446798121,1.6638069578676165,.6446838681910284],this.iiliiilili=[1,3.453538966854115,4.520892698785143,2.701273417835153,.6446879839978561,-2.0314516859987727e-7],this.iiliiiliil=[-1.3803835004508848e-8,.5000004915854026,1.6077979838469347,2.5645435828098253,2.0534873203680393,.7456698111156592],this.iiliiiliii=[1,2.882278766237617,4.168166055409092,2.7853527819234465,.7496767184804479,-.0005706911241624681],this.iiliiiilll=[6.894758194870125e-18,.49999999999998973,1.0177274392923794,2.498208511343429,2.1921221359427596,1.5897035272532765,.40154388356961734],this.iiliiiilli=[1,1.7021215452463931,4.4290431747556465,2.9745631894384923,2.3013614809773615,.28360399799075753,.022892987908906898]}lliillil(i){var l,t,h,r;if(i<=0)throw new Error("lngamma: bad arg "+i);for(h=i,t=i+5.2421875,t=(i+.5)*Math.log(t)-t,r=.9999999999999971,l=0;l<this.iiliililil;l++)r+=this.iiliililii[l]/++h;return t+Math.log(2.5066282746310007*r/i)}iiliiiilil(i){var l=Math.exp(this.lliillil(i));return Math.floor(i)==i?Math.floor(l+.5):l}iilliililll(i){var l,t=0;if(i<0){if((l=(i=1-i)-Math.floor(i))>.5&&(l-=1),0==l)return iiliiiilii;t=Math.PI/Math.tan(Math.PI*i)}if(i>=20)return this.iiliiiiill(i);for(;i>2;)t+=1/--i;for(;i<1;)t-=1/i,i+=1;return t+=this.iiliiiiili(i)}liiiilli(i,l){if(null==i)throw new Error("evaluate_polynomial");if(1==i.length)return i[0];if(2==i.length)return i[0]+l*i[1];for(var t=i.length-2,h=i[t+1];t>=0;)h*=l,h+=i[t],t--;return h}iiliiiiill(i){var l,t;return i--,t=Math.log(i),t+=1/(2*i),t-=(l=1/(i*i))*this.liiiilli(this.iiliiliiil,l)}iiliiiiili(i){var l,t;if(i<1||i>2)throw new Error("digamma_1_2: bad arg "+i);return l=i-this.iiliiillll,l-=this.iiliiillli,l-=this.iiliiillil,i-=1,t=this.liiiilli(this.iiliiliill,i)/this.liiiilli(this.iiliiliili,i),t=l*(this.iiliiliiii+t)}iiliiiiiil(i){var l;return i<=2?(this.iiliiillii+this.liiiilli(this.iiliiilill,i)/this.liiiilli(this.iiliiilili,i))/(i*i):i<=4?(l=1/i,(1+this.liiiilli(this.iiliiiliil,l)/this.liiiilli(this.iiliiiliii,l))/i):(l=1/i,(1+this.liiiilli(this.iiliiiilll,l)/this.liiiilli(this.iiliiiilli,l))/i)}iiliiiiiii(i){var l,t,h=0;return i<=0?(l=1-i,Math.floor(i)==i?iiliiiilii:(t=Math.abs(i)<Math.abs(l)?Math.sin(Math.PI*i):Math.sin(Math.PI*l),-this.iiliiiiiii(l)+Math.PI*Math.PI/(t*t))):(i<1&&(h=1/(i*i),i+=1),h+this.iiliiiiiil(i))}}class llliiillii extends lliiiliii{constructor(){super(),this.lllllii=[.0021695375159141994,.011413521097787704,.027972308950302116,.05172701560049242,.08250222548434094,.12007019910960293,.1641528330075247,.21442376986779355,.27051082840644336,.33199876341447887,.39843234186401943,.46931971407375483,.5441360555665797,.6223274528803108,.7033150046559717,.7864991076831345,.8712638961906152,.9569818015262914],this.liiiilii=[.005565719664244557,.01291594728406542,.020181515297735382,.027298621498568734,.03421381077029954,.04087575092364326,.04723508349026558,.05324471397775969,.0588601442453248,.06403979735501548,.06874532383573641,.07294188500565309,.07659841064587064,.07968782891207167,.0821872667043397,.08407821897966195,.08534668573933872,.08598327567039482],this.iiiillllll=18,this.llliiiiill=100,this.llliiiiili=3e3,this.llllilil=2.2e-16,this.llllllil=2.2e-38/this.llllilil;new Array(this.llilillil)}liillii(i){var l,t,h,r,s,n=[57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(i<=0)throw new Error("bad arg in gammln");for(r=t=i,h=t+5.2421875,h=(t+.5)*Math.log(h)-h,s=.9999999999999971,l=0;l<14;l++)s+=n[l]/++r;return h+Math.log(2.5066282746310007*s/t)}iilliililli(i){return Math.exp(this.iiiillllil(i))}iiiillllil(i){var l;if(this.liiillill)for(this.liiillill=!1,l=0;l<this.llilillil;l++)this.liiilllii[l]=this.liillii(l+1);if(i<0)throw new Error("negative arg in factln");return i<this.llilillil?this.liiilllii[i]:this.liillii(i+1)}iilliililil(i,l){var t;if(this.liiillill)for(this.liiillill=!1,t=0;t<this.llilillil;t++)this.liiilllii[t]=this.liillii(t+1);if(i<0)throw new Error("negative arg in factln");return i<this.llilillil?this.liiilllii[i]:this.liillii(i+1)}iilliililii(i,l){return Math.exp(this.liillii(i)+this.liillii(l)-this.liillii(i+l))}iiiillllii(i,l){if(l<0||i<=0)throw new Error("bad args in gammp");return 0==l?0:Math.floor(i)>=this.llliiiiill?this.llliiiiiil(i,l,1):l<i+1?this.llliiiiiii(i,l):1-this.llillillll(i,l)}iilliiliill(i,l){if(l<0||i<=0)throw new Error("bad args in gammp");return 0==l?0:Math.floor(i)>=this.llliiiiill?this.llliiiiiil(i,l,0):l<i+1?1-this.llliiiiiii(i,l):this.llillillll(i,l)}llliiiiiii(i,l){var t,h,r;for(iillllil=this.liillii(i),r=i,h=t=1/i;;)if(t+=h*=l/++r,Math.abs(h)<Math.abs(t)*this.llllilil)return t*Math.exp(-l+i*Math.log(l)-iillllil)}llillillll(i,l){var t,h,r,s,n,e,a;for(iillllil=this.liillii(i),r=l+1-i,s=1/this.llllllil,a=n=1/r,t=1;n=(h=-t*(t-i))*n+(r+=2),Math.abs(n)<this.llllllil&&(n=this.llllllil),s=r+h/s,Math.abs(s)<this.llllllil&&(s=this.llllllil),a*=e=(n=1/n)*s,!(Math.abs(e-1)<=this.llllilil);t++);return Math.exp(-l+i*Math.log(l)-iillllil)*a}llliiiiiil(i,l,t){var h,r,s,n,e,a=i-1,o=Math.log(a),f=Math.sqrt(a);for(iillllil=this.liillii(i),r=l>a?Math.max(a+11.5*f,l+6*f):Math.max(0,Math.min(a-7.5*f,l-5*f)),n=0,h=0;h<iiiillllll;h++)s=l+(r-l)*lllllii[h],n+=liiiilii[h]*Math.exp(-(s-a)+a*(Math.log(s)-o));return e=n*(r-l)*Math.exp(a*(o-1)-iillllil),t?l>a?1-e:-e:l>a?e:1+e}iilliiliili(i,l){var t,h,r,s,n,e,a,o=l-1;if(iillllil=this.liillii(l),l<=0)throw new Error("a must be pos in invgammap");if(i>=1)return Math.max(100,l+100*Math.sqrt(l));if(i<=0)return 0;for(l>1?(e=Math.log(o),a=Math.exp(o*(e-1)-iillllil),n=i<.5?i:1-i,h=(2.30753+.27061*(r=Math.sqrt(-2*Math.log(n))))/(1+r*(.99229+.04481*r))-r,i<.5&&(h=-h),h=Math.max(.001,l*Math.pow(1-1/(9*l)-h/(3*Math.sqrt(l)),3))):h=i<(r=1-l*(.253+.12*l))?Math.pow(i/r,1/l):1-Math.log(1-(i-r)/(1-r)),t=0;t<12;t++){if(h<=0)return 0;if((h-=r=(s=(this.iiiillllii(l,h)-i)/(r=l>1?a*Math.exp(-(h-o)+o*(Math.log(h)-e)):Math.exp(-h+o*Math.log(h)-iillllil)))/(1-.5*Math.min(1,s*((l-1)/h-1))))<=0&&(h=.5*(h+r)),Math.abs(r)<this.llllilil*h)break}return h}iiiiilili(i,l,t){var h;if(i<=0||l<=0)throw new Error("Bad iiil or illii in routine betai");if(t<0||t>1)throw new Error("Bad ili in routine betai");return 0==t||1==t?t:i>this.llliiiiili&&l>this.llliiiiili?this.iiiilllili(i,l,t):(h=Math.exp(this.liillii(i+l)-this.liillii(i)-this.liillii(l)+i*Math.log(t)+l*Math.log(1-t)),t<(i+1)/(i+l+2)?h*this.llillillli(i,l,t)/i:1-h*this.llillillli(l,i,1-t)/l)}llillillli(i,l,t){var h,r,s,n,e,a,o,f,w,g;for(w=i-1,n=1,e=1-(f=i+l)*t/(g=i+1),Math.abs(e)<this.llllllil&&(e=this.llllllil),o=e=1/e,h=1;h<1e4&&(e=1+(s=h*(l-h)*t/((w+(r=2*h))*(i+r)))*e,Math.abs(e)<this.llllllil&&(e=this.llllllil),n=1+s/n,Math.abs(n)<this.llllllil&&(n=this.llllllil),o*=(e=1/e)*n,e=1+(s=-(i+h)*(f+h)*t/((i+r)*(g+r)))*e,Math.abs(e)<this.llllllil&&(e=this.llllllil),n=1+s/n,Math.abs(n)<this.llllllil&&(n=this.llllllil),o*=a=(e=1/e)*n,!(Math.abs(a-1)<=this.llllilil));h++);return o}iiiilllili(i,l,t){var h,r,s,n,e,a=i-1,o=l-1,f=i/(i+l),w=log(f),g=log(1-f);if(s=i+l,s=Math.sqrt(i*l/(s*s*(i+l+1))),t>i/(i+l)){if(t>=1)return 1;r=Math.min(1,Math.max(f+10*s,t+5*s))}else{if(t<=0)return 0;r=Math.max(0,Math.min(f-10*s,t-5*s))}for(n=0,h=0;h<18;h++)s=t+(r-t)*lllllii[h],n+=liiiilii[h]*Math.exp(a*(Math.log(s)-w)+o*(Math.log(1-s)-g));return(e=n*(r-t)*Math.exp(a*w-this.liillii(i)+o*g-this.liillii(l)+this.liillii(i+l)))>0?1-e:-e}llillilili(i,l,t){var h,r,s,n,e,a,o,f,w,g=l-1,M=t-1;if(i<=0)return 0;if(i>=1)return 1;if(l>=1&&t>=1)r=i<.5?i:1-i,e=(2.30753+.27061*(s=Math.sqrt(-2*Math.log(r))))/(1+s*(.99229+.04481*s))-s,i<.5&&(e=-e),a=(e*e-3)/6,o=2/(1/(2*l-1)+1/(2*t-1)),f=e*Math.sqrt(a+o)/o-(1/(2*t-1)-1/(2*l-1))*(a+5/6-2/(3*o)),e=l/(l+t*Math.exp(2*f));else{var u=Math.log(l/(l+t)),v=Math.log(t/(l+t));e=i<(s=Math.exp(l*u)/l)/(f=s+(n=Math.exp(t*v)/t))?Math.pow(l*f*i,1/l):1-Math.pow(t*f*(1-i),1/t)}for(w=-this.liillii(l)-this.liillii(t)+this.liillii(l+t),h=0;h<10;h++){if(0==e||1==e)return e;if((e-=s=(n=(this.iiiiilili(l,t,e)-i)/(s=Math.exp(g*Math.log(e)+M*Math.log(1-e)+w)))/(1-.5*Math.min(1,n*(g/e-M/(1-e)))))<=0&&(e=.5*(e+s)),e>=1&&(e=.5*(e+s+1)),Math.abs(s)<1e-8*e&&h>0)break}return e}}class iiiillilll extends llliiillii{constructor(i){super(),void 0===i&&(i=1),this.lliili=0,this.llliiiil=0,this.llilliliil(i)}llilliliil(i){if(void 0===i)throw new Error("invalid lliili parameter");var l=new lliiiliii;if(this.lliili=i,i.length>1){this.llliiiil=new Array(i.length);for(var t=0;t<i.length;t++){if(i[t]<=0)throw new Error("bad lliili="+i[t]);this.llliiiil[t]=l.lliillil(.5*(i[t]+1))-.5*Math.log(i[t]*Math.PI)-l.lliillil(.5*i[t])}}else{if(i<=0)throw new Error("bad lliili="+i);this.llliiiil=l.lliillil(.5*(i+1))-.5*Math.log(i*Math.PI)-l.lliillil(.5*i)}}iiiillilli(i){if(void 0===i)throw new Error("invalid parameters");if(void 0===i.length||i.length<1)throw new Error("invalid parameters");this.llilliliil(i[0])}iiiillilil(i){return i.length>1?Math.exp(this.iiiiiilil(i)):Math.exp(this.llliiiil-.5*(this.lliili+1)*Math.log(1+i*i/this.lliili))}iiiillilii(i){var l,t;if(t=new Array(i.length),i.length==this.lliili.length)for(l=0;l<i.length;l++)t[l]=Math.exp(this.llliiiil[l]-.5*(this.lliili[l]+1)*Math.log(1+i[l]*i[l]/this.lliili[l]));else for(l=0;l<i.length;l++)t[l]=Math.exp(this.llliiiil-.5*(this.lliili+1)*Math.log(1+i[l]*i[l]/this.lliili));return t}iiiiiilil(i){var l,t;if(i.length>1){if(t=0,i.length==this.lliili.length){for(l=0;l<i.length;l++)t+=this.llliiiil[l]-.5*(this.lliili[l]+1)*Math.log(1+i[l]*i[l]/this.lliili[l]);return t}for(l=0;l<i.length;l++)t+=Math.log(1+i[l]*i[l]/this.lliili);return i.length*this.llliiiil-.5*(this.lliili+1)*t}return this.llliiiil-.5*(this.lliili+1)*Math.log(1+i*i/this.lliili)}llilliilll(i){var l,t;if(t=new Array(i.length),i.length==this.lliili.length)for(l=0;l<i.length;l++)t[l]=this.llliiiil[l]-.5*(this.lliili[l]+1)*Math.log(1+i[l]*i[l]/this.lliili[l]);else for(l=0;l<i.length;l++)t[l]=this.llliiiil-.5*(this.lliili+1)*Math.log(1+i[l]*i[l]/this.lliili);return t}iilliiliiil(i){var l=new lliiiliii,t=new iilliiliiii,h=.5*this.lliili,r=Math.sqrt(this.lliili)*Math.abs(i);return t.iiliillllll(h,r)*Math.exp(h*Math.log(r))/(l.iiliiiilil(h)*Math.exp(Math.log(2)*(h-1)))}iiiiiilii(i){var l=.5*this.iiiiilili(.5*this.lliili,.5,this.lliili/(this.lliili+i*i));return i>=0?1-l:l}iiiilliili(i){if(i<=0||i>=1)throw new Error("bad lllili in StudentDist");var l=this.llillilili(2*Math.min(i,1-i),.5*this.lliili,.5);return l=Math.sqrt(this.lliili*(1-l)/l),i>=.5?+l:-l}}class iiiilliiil extends llliiillii{constructor(i,l){if(super(),void 0===i&&(i=1),void 0===l&&(l=1),i<=0)throw new Error("bad llliil="+i);if(l<=0)throw new Error("bad illill="+l);this.llliil=0,this.illill=0,this.iiliillllli=0,this.llilliilli(i,l)}llilliilli(i,l){if(void 0===i)throw new Error("invalid llliil parameter");if(void 0===l)throw new Error("invalid illill parameter");var t=new lliiiliii;if(i.length>1){if(i.length!=l.length)throw new Error("incompatible parameters");this.llliiiil=new Array(i.length);for(var h=0;h<i.length;h++){if(i[h]<=0)throw new Error("bad llliil="+i[h]);if(l[h]<=0)throw new Error("bad illill="+l[h]);this.llililiii[h]=.5*(i[h]*Math.log(i[h])+l[h]*Math.log(l[h]))+t.lliillil(.5*(i[h]+l[h]))-t.lliillil(.5*i[h])-t.lliillil(.5*l[h])}}else{if(i<=0)throw new Error("bad llliil="+i);if(l<=0)throw new Error("bad illill="+l);this.llililiii=.5*(i*Math.log(i)+l*Math.log(l))+t.lliillil(.5*(i+l))-t.lliillil(.5*i)-t.lliillil(.5*l)}this.llliil=i,this.illill=l}iiiillilli(i){if(void 0===i)throw new Error("invalid parameters");if(void 0===i.length||i.length<2)throw new Error("invalid parameters");this.llilliilli(i[0],i[1])}iiiillilil(i){return i.length>1?Math.exp(this.iiiiiilil(i)):Math.exp(this.llililiii+(.5*this.llliil-1)*Math.log(i)-.5*(this.llliil+this.illill)*Math.log(this.illill+this.llliil*i))}iiiillilii(i){var l,t;for(t=this.llilliilll(i),l=0;l<t.length;l++)t[l]=Math.exp(t[l]);return t}iiiiiilil(i){var l,t;if(i.length>1){if(t=0,i.length==this.llliil.length){for(l=0;l<i.length;l++){if(i[l]<0)return-1/0;t+=this.llililiii[l]+(.5*this.llliil[l]-1)*Math.log(i[l])-.5*(this.llliil[l]+this.illill[l])*Math.log(this.illill[l]+this.llliil[l]*i[l])}return t}for(l=0;l<i.length;l++){if(i[l]<0)return-1/0;t+=(.5*this.llliil-1)*Math.log(i[l])-.5*(this.llliil+this.illill)*Math.log(this.illill+this.llliil*i[l])}return i.length*this.llililiii+t}return i<0?-1/0:this.llililiii+(.5*this.llliil-1)*Math.log(i)-.5*(this.llliil+this.illill)*Math.log(this.illill+this.llliil*i)}llilliilll(i){var l,t;if(t=new Array(i.length),i.length==this.llliil.length)for(l=0;l<i.length;l++)i[l]<0?t[l]=-1/0:t[l]=this.iiiilliiii[l]+(.5*this.llliil[l]-1)*Math.log(i[l])-.5*(this.llliil[l]+this.illill[l])*Math.log(this.illill[l]+this.llliil[l]*i[l]);else for(l=0;l<i.length;l++)i[l]<0?t[l]=-1/0:t[l]=this.iiiilliiii+(.5*this.llliil-1)*Math.log(i)-.5*(this.llliil+this.illill)*Math.log(this.illill+this.llliil*i);return t}iiiiiilii(i){if(i<0)throw new Error("bad ili in FDist");return this.iiiiilili(.5*this.llliil,.5*this.illill,this.llliil*i/(this.illill+this.llliil*i))}iiiilliili(i){if(i<0||i>1)throw new Error("bad lllili in FDist");var l=this.llillilili(i,.5*this.llliil,.5*this.illill);return this.illill*l/(this.llliil*(1-l))}}class iiiilillll{constructor(i){if(void 0!==i){if(void 0===i.length)throw new Error("bad input");var l,t,h,r;for(this.liili=i.length,l=0;l<this.liili;l++){if(i[l].length!=this.liili)throw new Error("bad row "+l);for(h=i[l],t=l+1;t<this.liili;t++)if(r=i[t],h[t]!=r[l])throw new Error("nonsymmetric input: "+h[t]+" != "+r[l])}for(this.iiil=i,this.lllillii=new Array(this.liili),l=0;l<this.liili;l++)for(this.lllillii[l]=new Array(this.liili),h=this.lllillii[l],r=i[l],t=0;t<this.liili;t++)h[t]=r[t];for(this.iiiilillli(),this.liiililll=1,l=0;l<this.liili;l++)this.liiililll*=this.lllillii[l][l];this.liiililll=this.liiililll*this.liiililll}}iiiilillli(){var i,l,t,h,r,s;for(i=0;i<this.liili;i++)for(r=this.lllillii[i],l=i;l<this.liili;l++){for(s=this.lllillii[l],h=0,t=i-1;t>=0;t--)h+=r[t]*s[t];if(h=r[l]-h,l==i){if(h<0)throw new Error("matrix is not positive-definite");r[i]=Math.sqrt(h)}else s[i]=h/r[i]}for(i=1;i<this.liili;i++)for(r=this.lllillii[i],l=0;l<i;l++)this.lllillii[l][i]=r[l]}iiliillllil(i,l){var t,h,r,s;if(i.length!=this.liili)throw new Error("incompatible illii vector");if(l.length!=this.liili)throw new Error("incompatible ili vector");for(t=0;t<this.liili;t++){for(s=this.lllillii[t],r=i[t],h=t-1;h>=0;h--)r-=s[h]*l[h];l[t]=r/s[t]}for(t=this.liili-1;t>=0;t--){for(r=l[t],h=t+1;h<this.liili;h++)r-=this.lllillii[h][t]*l[h];l[t]=r/this.lllillii[t][t]}}iiiilillil(){var i,l,t,h,r,s;for(this.lllllllii=new Array(this.liili),i=0;i<this.liili;i++)for(this.lllllllii[i]=new Array(this.liili),r=this.lllillii[i],l=0;l<=i;l++){for(s=this.lllllllii[l],h=i==l?1:0,t=i-1;t>=l;t--)h-=r[t]*s[t];s[i]=h/r[i]}for(i=this.liili-1;i>=0;i--)for(r=this.lllillii[i],l=0;l<=i;l++){for(s=this.lllllllii[l],h=i<l?0:s[i],t=i+1;t<this.liili;t++)h-=this.lllillii[t][i]*s[t];this.lllllllii[i][l]=this.lllllllii[l][i]=h/r[i]}}}class iiiilillii{constructor(){this.lllliill=[],this.lliliilil=[],this.lllliiill=[],this.iillli=[],this.llllllii=0,this.illiliil=0,this.lllliiili=[],this.lllliiiil=[],this.min=[],this.max=[]}llilliilil(i,l){var t,h,r;if(void 0!==i&&void 0!==l&&void 0!==l.length){for(h=l.length,this.lllliill.push(i),this.lliliilil.push("scalar"),this.lllliiill.push(h),r=new Array(h),t=0;t<h;t++)r[t]=l[t];this.iillli.push(r),this.lllliiili.push(0),this.lllliiiil.push(0),this.min.push(0),this.max.push(0),this.illiliil++}}iiliillllii(i){var l=this.lllliill.indexOf(i);return l>=0&&l<this.iillli.length?this.iillli[l]:null}iiliilllill(i){return i>=0&&i<this.iillli.length?this.iillli[i]:null}iiiililill(i,l){var t,h;if(void 0!==i&&void 0!==i.length&&void 0!==l){if(l<=0)throw new Error("positive llllllii required");for(h=i.length,this.llllllii=l,this.illiliil=h,t=0;t<h;t++)this.lllliill.push(i[t]),this.lliliilil.push("scalar"),this.lllliiill.push(l),this.iillli.push(new Array(l)),this.lllliiili.push(0),this.lllliiiil.push(0),this.min.push(0),this.max.push(0)}}iiiililili(i,l){var t,h;if(void 0===this.iillli.length)throw new Error("Dataset: empty dataset");if(l.length!=this.iillli.length)throw new Error("Dataset: wrong record");for(t=0;t<l.length;t++){if(h=this.iillli[t],i<0||i>=h.length)throw new Error("Dataset: wrong index");var r=Number(l[t]);isNaN(r)?(l[t]=l[t].trim(),this.lliliilil[t]="string",h[i]=l[t]):h[i]=Number(l[t])}}iiliilllili(i){var l,t,h,r,s,n;if(!((t=this.lllliill.indexOf(i))<0)){for(n=[],l=0;l<this.llllllii;l++)r=this.iillli[t][l],n.indexOf(r)<0&&n.push(r);if(n.sort(),!(n.length<2))for(h=1;h<n.length;h++){for(s=new Array(this.llllllii),l=0;l<this.llllllii;l++)s[l]=this.iillli[t][l]==n[h]?1:0;this.llilliilil(this.lllliill[t]+n[h].toString(),s)}}}iiliillliil(i,l){var t,h,r,s,n,e;if(void 0!==l.length&&!((h=this.lllliill.indexOf(i))<0)){for(e=[],r=0;r<l.length;r++){for(n=new Array(this.llllllii),t=s=l[r];t<this.llllllii;t++)n[t]=this.iillli[h][t-s];this.llilliilil(this.lllliill[h]+".l"+s.toString(),n),e.push(this.lllliill.length-1)}return e}}iiiililiil(i){var l;for(l=0;l<this.iillli.length;l++)this.iillli[l].length=i,this.lllliiill[l]=i;this.llllllii=i}iiiililiii(){var i,l,t,h,r;for(l=0;l<this.iillli.length;l++)if("scalar"!=this.lliliilil[l])for(h=this.iillli[l],r=[],i=0;i<h.length;i++)(t=r.indexOf(h[i]))>=0?h[i]=t+1:(r.push(h[i]),h[i]=r.length)}iiliillliii(i){var l,t,h,r;if(void 0!==i.length){for(h=[],l=0;l<this.llllllii;l++)i.indexOf(l)<0&&h.push(l);for(r=h.length,t=0;t<this.iillli.length;t++){for(l=0;l<r;l++)this.iillli[t][l]=this.iillli[t][h[l]];this.iillli[t].length=r,this.lllliiill[t]=r}return this.llllllii=r,r}}iiliillilll(){var i,l,t,h,r,s,n,e;if(!(this.iillli.length<1))for(this.iiiililiii(),l=0;l<this.iillli.length;l++)if(t=this.lllliiill[l],h=this.iillli[l],!(t<1))if(t<2)this.lllliiili[l]=h[0],this.lllliiiil[l]=0;else{for(r=0,s=0,n=h[0],e=h[0],i=0;i<t;i++)r+=h[i],s+=h[i]*h[i],n>h[i]&&(n=h[i]),e<h[i]&&(e=h[i]);r/=t,this.lllliiili[l]=r,this.lllliiiil[l]=Math.sqrt((s-t*r*r)/(t-1)),this.min[l]=n,this.max[l]=e}}iiliillilli(){var i,l,t,h,r,s;if(!(this.iillli.length<1))for(l=0;l<this.iillli.length;l++)for(t=this.lllliiill[l],h=this.iillli[l],r=this.lllliiili[l],s=Math.sqrt(t)/this.lllliiiil[l],i=0;i<t;i++)h[i]-=r,h[i]*=s}iiliillilil(i,l){void 0===l&&(l=this.illiliil-1);for(var t=[],h=[],r=this.iillli[l],s=this.lllliill[l],n=0;n<this.illiliil;n++)addRow(i,[this.lllliill[n],this.lliliilil[n],this.lllliiili[n],this.lllliiiil[n],this.min[n],this.max[n]]),n!=l&&(t.push(this.iillli[n]),h.push(this.lllliill[n]));return h.push("bias"),{x:t,y:r,xvars:h,yvar:s}}}class llilliiill{constructor(i,l,t){this.init(i,l,t)}init(i,l,t){if(void 0!==i&&""!=i){void 0===l&&(l=!0),void 0===t&&(t=","),this.iilliill=t;var h,r,s,n,e=i.split("\n");if(this.lliilllll=e.length,this.lllilllli=e[0].split(t),this.illiliil=this.lllilllli.length,this.lllllilil=null,l)for(s=1,this.lliilllll=this.lliilllll-1,h=0;h<this.illiliil;h++)this.lllilllli[h]=this.lllilllli[h].trim();else for(this.lllilllli=new Array(this.illiliil),s=0,h=0;h<this.illiliil;h++)this.lllilllli[h]="v"+h;if(!(this.lliilllll<1))for(this.lllllilil=new iiiilillii,this.lllllilil.iiiililill(this.lllilllli,this.lliilllll),n=new Array(this.illiliil),r=0;r<this.lliilllll;r++){n=e[s+r].split(t);try{this.lllllilil.iiiililili(r,n)}catch(i){this.lllllilil.iiiililiil(r);break}}}}async iiliillilii(i,l){if("object"!=typeof i)throw new Error("readTextFile: input must be File or Blob object");let t=await new Promise(l=>{var t=new FileReader;t.onload=function(i){l(i.target.result)},t.readAsText(i)});this.init(t),void 0!==l&&l(this)}iiiiliilii(){return"x1,x2,y\n1.0255878,2.1186969,8.3526964\n.042631123,2.2723138,7.8639932\n-.70228761,2.431756,5.79813\n-2.7221317,2.7970607,3.0946233\n-1.7291995,2.5824113,4.5145931\n-.13817392,2.1161199,5.5865245\n-1.239354,2.7422509,5.0796804\n-.48345101,2.2617774,4.5243707\n-2.8120158,2.8069861,2.3767087\n-2.0151243,2.667398,3.0826864\n.095367581,2.2427154,6.7732477\n.33264923,2.6291511,8.2425184\n-1.360688,2.5329022,4.0888076\n-.2648944,2.7275901,7.7965074\n-1.9614829,2.6358731,4.7292967\n-.24787003,2.3089771,6.5446115\n-1.4666531,2.0315943,3.3872509\n-3.4520764,2.7675204,.46285015\n-3.3220057,2.7826505,1.4121252\n-1.6115704,2.4032831,4.6827612\n-1.4618155,2.2183805,3.7993503\n1.4363157,2.6543801,12.29566\n-1.2123415,2.6249385,4.7441268\n-1.8114582,2.6531339,4.3893933\n-.97956884,2.8717756,6.3585887\n-.091025531,2.3228788,6.5700746\n.00046767941,2.7929983,9.67974\n-.95999455,2.8905411,6.8935084\n.74333578,2.5850651,10.792482\n-1.3708646,2.1650915,4.005105\n-1.1547564,2.2137027,4.8535166\n-2.5544586,2.7540336,3.0827487\n-1.7080315,2.4879022,4.5158682\n-1.0601965,2.784761,7.3696733\n-1.0790126,2.3591983,4.4072514\n-.39444384,2.2747245,7.2656965\n-1.8665135,2.3598654,2.2092383\n-.56962001,2.4099021,5.8160834\n-1.9160471,2.74529,3.977314\n-.075811483,2.6489046,7.4588618\n-.86596292,2.0247171,4.0750008\n.023776416,2.895196,9.2430706\n-.79931176,2.302567,5.4220171\n-1.4237095,2.9094009,6.315999\n-.68967009,2.1980503,3.8910472\n-1.5142499,2.9396281,6.1558914\n-1.7490882,2.9796002,4.0121632\n-2.3541639,2.0194468,.99724203\n-1.6525941,2.6482322,4.5748982\n-.9671154,2.4484186,5.2090769\n-1.6189822,2.6840329,5.6619306\n-1.9560616,2.174686,1.4077981\n-.28968105,2.0751765,5.8627734\n-1.0171468,2.2528915,4.0621834\n.79308754,2.0983407,7.2743225\n-1.6413133,2.5191939,4.1583242\n-.086207315,2.2439508,6.6908307\n-1.5650643,2.7611632,4.7687907\n-1.6269404,2.4834259,2.2210412\n-.96702713,2.4842453,6.9653053\n-2.3116972,2.4731467,2.6432104\n-.96786249,2.7108121,5.6429586\n-2.2278395,2.1495154,.33729535\n-1.6824137,2.9263856,8.2091904\n.032709174,2.3883541,5.4945812\n-1.1106868,2.3072758,5.1833162\n-1.7403983,2.87339,6.6352353\n-1.1817126,2.9820004,8.3581877\n-.20944396,2.7621315,9.400548\n-1.4528557,2.7449422,6.1368213\n-3.5662911,2.3134475,.53312039\n-1.9870924,2.7424037,5.1591325\n.21385378,2.3216975,4.7069187\n.14790024,2.4831383,6.4673128\n-2.8459058,2.9508841,2.6368821\n-.75333428,2.5302432,6.9539313\n-1.0849732,2.026788,4.9505353\n-1.1620399,2.4755278,3.5338876\n-.51459992,2.0965431,5.501379\n-1.2555816,2.2699718,3.1097682\n-1.2768313,2.9286809,6.1300988\n-1.6544462,2.8276467,4.4957128\n-2.3361845,2.0883415,-.41387844\n-1.0546583,2.202038,4.1135712\n-.85962743,2.2142248,3.5906494\n-1.9984499,2.629122,3.3542929\n-2.2917063,2.4517648,4.3078589\n.70536387,2.8285236,10.985337\n-1.3663574,2.1816306,2.3660624\n.3680906,2.5259433,7.6479578\n-1.5294532,2.0401554,3.7878008\n-2.1219931,2.8173847,3.4883804\n-1.2736341,2.0181899,4.9359651\n-.63676751,2.8708923,5.4779353\n-.68778855,2.7101488,7.9129963\n-1.6627333,2.2058177,3.5267422\n-1.1025308,2.1334636,4.3948154\n-1.760644,2.2760108,4.751389\n-1.5178248,2.6522317,5.1778464\n-.65247577,2.3502681,5.2666039"}}function llliiilll(i,l,t){if(void 0===t&&(t=1e-14),void 0===l)throw new Error(i+" != undefined");if(Math.abs(i-l)>t)throw new Error("values are not equal: "+i+" != "+l)}function iiliilliill(i,l,t){if(void 0===t&&(t=1e-14),void 0===l)throw new Error(i+" != undefined");if(Math.abs(i-l)>t*(1+Math.abs(i)+Math.abs(l)))throw new Error("values are not equal: "+i+" != "+l)}function iiliilliili(i,l,t){var h,r;if(void 0===t&&(t=1e-14),void 0===l)throw new Error(i+" != undefined");if(r=i.length,l.length!=r)throw new Error("vectors not equal length: "+i.length+" != "+l.length);for(h=0;h<r;h++)if(Math.abs(i[h]-l[h])>t)throw new Error("values are not equal: "+i[h]+" != "+l[h])}function iiliilliiil(i,l){if(void 0===l&&(l=1e-14),void 0===i)throw new Error("x is undefined");if(i<=l)throw new Error("value not greater: "+i+" !> "+l)}function iiliilliiii(i,l,t){if(void 0===i)throw new Error(i+" != undefined");if(void 0===l)throw new Error("a undefined");if(void 0===t)throw new Error("b undefined");if(i<l||i>t)throw new Error(i+" not in ["+l+", "+t+"]")}class iiiiliiill{constructor(i,l){var t;if(void 0!==i&&void 0!==l){if(void 0===i.length)throw new Error("bad input");if(void 0===i[0])throw new Error("bad input");if(i[0].length!=l.length)throw new Error("bad input");if(i.length>=l.length)throw new Error("underdetermined model");this.ili=i,this.lllllii=l,this.lllili=this.ili.length,this.liili=this.ili[0].length;var h=new Array(this.liili);for(t=0;t<this.liili;t++)h[t]=1;this.ili.push(h),this.lllili++,this.iiiiliiili()}}iiiiliiili(){var i,l,t,h,r;for(this.liiiliiii=0,t=0;t<this.liili;t++)this.liiiliiii+=this.lllllii[t];for(this.liiiliiii/=this.liili,this.lllllilii=new Array(this.lllili),this.llililllli=new Array(this.lllili),this.illii=new Array(this.lllili),i=0;i<this.lllili;i++){if(this.ili[i].length!=this.liili)throw new Error("bad row "+i);for(this.lllllilii[i]=new Array(this.lllili),l=0;l<this.lllili;l++){for(h=0,t=0;t<this.liili;t++)h+=this.ili[i][t]*this.ili[l][t];this.lllllilii[i][l]=h}for(h=0,t=0;t<this.liili;t++)h+=this.ili[i][t]*this.lllllii[t];this.llililllli[i]=h}for(this.liiiillll=new iiiilillll(this.lllllilii),this.liiiillll.iiiilillil(),i=0;i<this.lllili;i++){for(r=this.liiiillll.lllllllii[i],h=0,l=0;l<this.lllili;l++)h+=r[l]*this.llililllli[l];this.illii[i]=h}}lliilllli(){var i,l,t,h,r;for(this.llllllllli=0,l=0;l<this.liili;l++)t=this.lllllii[l]-this.liiiliiii,this.llllllllli+=t*t;for(this.llllllllil=new Array(this.liili),this.lliilllli=new Array(this.liili),r=0,h=0,l=0;l<this.liili;l++){for(t=0,i=0;i<this.lllili;i++)t+=this.ili[i][l]*this.illii[i];this.llllllllil[l]=t,this.lliilllli[l]=this.lllllii[l]-this.llllllllil[l],r+=this.lliilllli[l]*this.lliilllli[l],h+=(t=this.llllllllil[l]-this.liiiliiii)*t}this.llllllllii=h,this.iiliilillll=this.llllllllli-this.llllllllii,this.lliilllil=this.llllllllii/this.llllllllli,this.iiliilillli=1-(1-this.lliilllil)*(this.liili-1)/(this.liili-this.lllili),this.liiiillli=r/(this.liili-this.lllili),this.iiliilillil=Math.sqrt(this.liiiillli),this.iiiiliiiil=this.llllllllii/(this.liiiillli*(this.lllili-1));var s=new iiiilliiil(this.lllili-1,this.liili-this.lllili);this.iiliilillii=1-s.iiiiiilii(this.iiiiliiiil)}iiiiilllll(){var i,l;if(void 0===this.liiiillll)throw new Error("cov is undefined");if(void 0===this.liiiillli)throw new Error("MSE is undefined");for(this.lliilllii=new Array(this.lllili),this.llililllii=new Array(this.lllili),this.iiiiilllli=new Array(this.lllili),l=new iiiillilll(this.liili-this.lllili),i=0;i<this.lllili;i++)this.lliilllii[i]=Math.sqrt(this.liiiillli*this.liiiillll.lllllllii[i][i]),this.llililllii[i]=this.illii[i]/this.lliilllii[i],this.iiiiilllli[i]=2*(1-l.iiiiiilii(Math.abs(this.llililllii[i])))}test(){var i,l,t,h=new llilliiill;i=[(h=new llilliiill(h.iiiiliilii())).lllllilil.iillli[0],h.lllllilil.iillli[1]],l=h.lllllilil.iillli[2],(t=new iiiiliiill(i,l)).lliilllli(),t.iiiiilllll(),llliiilll(2.111035530207872,t.illii[0],1e-12),llliiilll(3.671236640283667,t.illii[1],1e-12),llliiilll(-1.5887610544774788,t.illii[2],1e-12),llliiilll(.1026530004526018,t.lliilllii[0],1e-12),llliiilll(.349438081942895,t.lliilllii[1],1e-12),llliiilll(.8631992795922303,t.lliilllii[2],1e-12)}}
