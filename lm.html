<!DOCTYPE html>
<html>
  <head>
    <title>Linear Model</title>
    <style>
    	body {
    		background: #808088;
    	}
    	h1 {
    		text-align: center;
    		color: #ffffff;
    	}
    	

    	#model {
    		background: #404044;
    		border: 0;
    		width: 50%;
    		margin: auto;
    		padding: 16px;
    		color: white;
    	}
    	
    	textarea {
    		/* set display: block so margin has an effect */
    		display: block;
    		height: 250px;
    		width: 75%;
    		margin: auto;
    	}

    	#datasummary, #modelsummary {
			margin: auto;
			padding: 20px;
    	}

    	h2 {
    		text-align: center;
    	}

		table {
			background: #404044;
  			border-collapse: collapse;
  			border: 2px solid rgb(200,200,200);
  			letter-spacing: 1px;
  			font-size: 0.8rem;
		}

		td, th {
 	 		border: 1px solid rgb(190,190,190);
  			padding: 10px 20px;
  			color: black;
		}

		th {
  			background-color: rgb(225,225,225);
		}

		td {
  			text-align: center;
		}
		
		tr:nth-child(even) td {
  			background-color: rgb(250,250,250);
		}

		tr:nth-child(odd) td {
  			background-color: rgb(245,245,245);
		}
		
		caption {
			color: white;
			font-size: 32px;
  			padding: 10px;
		}

		canvas {
			background: #888;
			padding: 10px; 
			margin:auto;
		}

    </style>
  </head>

  <body>

  	<h1>Linear Model</h1>
	<script src="js/lm.js"></script>

	<form id="model">

		<h2>CSV Input</h2>
  		<textarea id="csvinput" name="csvinput" cols="40", rows="50" wrap>
		</textarea>

	<table id="datasummary">
      <caption>Dataset Summary</caption>
      <thead>
        <tr>
          <th scope="col">var</th>
          <th scope="col">type</th>
          <th scope="col">Mean</th>
          <th scope="col">Std. Dev.</th>
          <th scope="col">Min</th>
          <th scope="col">Max</th>
        </tr>
      </thead>
    </table>

	<table id="modelsummary">
      <caption>Model Summary</caption>
      <thead>
        <tr>
          <th scope="col"></th>
          <th scope="col">Coef.</th>
          <th scope="col">Std. Err.</th>
          <th scope="col">t</th>
          <th scope="col">P>|t|</th>
        </tr>
      </thead>
    </table>

    <p>
    </p>
	<div id="plots" style="display:flex;flex-direction:column;">
	</div>

	</form>

<div class='filename'>x1x2y.csv</div>
<div><pre class=code>number:Int,english,french,german
x1,x2,y
1.0255878,2.1186969,8.3526964
.042631123,2.2723138,7.8639932
-.70228761,2.431756,5.79813
-2.7221317,2.7970607,3.0946233
-1.7291995,2.5824113,4.5145931
-.13817392,2.1161199,5.5865245
-1.239354,2.7422509,5.0796804
-.48345101,2.2617774,4.5243707
-2.8120158,2.8069861,2.3767087
-2.0151243,2.667398,3.0826864
.095367581,2.2427154,6.7732477
.33264923,2.6291511,8.2425184
-1.360688,2.5329022,4.0888076
-.2648944,2.7275901,7.7965074
-1.9614829,2.6358731,4.7292967
-.24787003,2.3089771,6.5446115
-1.4666531,2.0315943,3.3872509
-3.4520764,2.7675204,.46285015
-3.3220057,2.7826505,1.4121252
-1.6115704,2.4032831,4.6827612
-1.4618155,2.2183805,3.7993503
1.4363157,2.6543801,12.29566
-1.2123415,2.6249385,4.7441268
-1.8114582,2.6531339,4.3893933
-.97956884,2.8717756,6.3585887
-.091025531,2.3228788,6.5700746
.00046767941,2.7929983,9.67974
-.95999455,2.8905411,6.8935084
.74333578,2.5850651,10.792482
-1.3708646,2.1650915,4.005105
-1.1547564,2.2137027,4.8535166
-2.5544586,2.7540336,3.0827487
-1.7080315,2.4879022,4.5158682
-1.0601965,2.784761,7.3696733
-1.0790126,2.3591983,4.4072514
-.39444384,2.2747245,7.2656965
-1.8665135,2.3598654,2.2092383
-.56962001,2.4099021,5.8160834
-1.9160471,2.74529,3.977314
-.075811483,2.6489046,7.4588618
-.86596292,2.0247171,4.0750008
.023776416,2.895196,9.2430706
-.79931176,2.302567,5.4220171
-1.4237095,2.9094009,6.315999
-.68967009,2.1980503,3.8910472
-1.5142499,2.9396281,6.1558914
-1.7490882,2.9796002,4.0121632
-2.3541639,2.0194468,.99724203
-1.6525941,2.6482322,4.5748982
-.9671154,2.4484186,5.2090769
-1.6189822,2.6840329,5.6619306
-1.9560616,2.174686,1.4077981
-.28968105,2.0751765,5.8627734
-1.0171468,2.2528915,4.0621834
.79308754,2.0983407,7.2743225
-1.6413133,2.5191939,4.1583242
-.086207315,2.2439508,6.6908307
-1.5650643,2.7611632,4.7687907
-1.6269404,2.4834259,2.2210412
-.96702713,2.4842453,6.9653053
-2.3116972,2.4731467,2.6432104
-.96786249,2.7108121,5.6429586
-2.2278395,2.1495154,.33729535
-1.6824137,2.9263856,8.2091904
.032709174,2.3883541,5.4945812
-1.1106868,2.3072758,5.1833162
-1.7403983,2.87339,6.6352353
-1.1817126,2.9820004,8.3581877
-.20944396,2.7621315,9.400548
-1.4528557,2.7449422,6.1368213
-3.5662911,2.3134475,.53312039
-1.9870924,2.7424037,5.1591325
.21385378,2.3216975,4.7069187
.14790024,2.4831383,6.4673128
-2.8459058,2.9508841,2.6368821
-.75333428,2.5302432,6.9539313
-1.0849732,2.026788,4.9505353
-1.1620399,2.4755278,3.5338876
-.51459992,2.0965431,5.501379
-1.2555816,2.2699718,3.1097682
-1.2768313,2.9286809,6.1300988
-1.6544462,2.8276467,4.4957128
-2.3361845,2.0883415,-.41387844
-1.0546583,2.202038,4.1135712
-.85962743,2.2142248,3.5906494
-1.9984499,2.629122,3.3542929
-2.2917063,2.4517648,4.3078589
.70536387,2.8285236,10.985337
-1.3663574,2.1816306,2.3660624
.3680906,2.5259433,7.6479578
-1.5294532,2.0401554,3.7878008
-2.1219931,2.8173847,3.4883804
-1.2736341,2.0181899,4.9359651
-.63676751,2.8708923,5.4779353
-.68778855,2.7101488,7.9129963
-1.6627333,2.2058177,3.5267422
-1.1025308,2.1334636,4.3948154
-1.760644,2.2760108,4.751389
-1.5178248,2.6522317,5.1778464
-.65247577,2.3502681,5.2666039
</pre></div>

	  <script> 
	  		function deleteRows(tableID) {
  				// Get a reference to the table
  				var tableRef = document.getElementById(tableID);
  				var n = tableRef.rows.length;
  				//console.log("tableRef.rows", n);
  				for (var j = 1; j < n; j++) {
  					tableRef.deleteRow(-1);
  				}
			};  
  			function addRow(tableID, rowvec, digits) {
  				if (typeof digits == "undefined") digits = 6;
  				var tableRef = document.getElementById(tableID);
  				var row = tableRef.insertRow(-1);
  				var hcell = document.createElement("TH");
  				hcell.appendChild(document.createTextNode(rowvec[0]));
  				row.appendChild(hcell);
  				for(var i = 1; i < rowvec.length; i++) {
  					var dcell = document.createElement("TD");
  					if (typeof rowvec[i] == "number")
  						if (digits.length == rowvec.length)
  							dcell.appendChild(document.createTextNode(rowvec[i].toPrecision(digits[i])));
  						else
  							dcell.appendChild(document.createTextNode(rowvec[i].toPrecision(digits)));
  					else
  						dcell.appendChild(document.createTextNode(rowvec[i]));
  					row.appendChild(dcell);
  				}
			};
			var input = document.getElementById("csvinput");
			input.addEventListener("input", function() {
				if (input.value.trim() == "") {
					return;
				}
				deleteRows("datasummary");
				deleteRows("modelsummary");
				try {
					csv = new llilliiill(input.value);
					var ds = csv.lllllilil; 
					ds.iiliillilll();
					if (ds.illiliil < 1 || ds.llllllii < 1) {
						return;
					}
					var mod = ds.iiliillilil("datasummary");
					var x = mod.x;
					var y = mod.y;
					var xvars = mod.xvars;
					var yvar  = mod.yvar;
					var tableRef = document.getElementById("modelsummary");
					var nodes = tableRef.tHead.children[0].children[0].childNodes;
					if (nodes.length > 0) {
						tableRef.tHead.children[0].children[0].replaceChild(
								document.createTextNode(yvar), nodes[0]);
					}
					else {
						tableRef.tHead.children[0].children[0].appendChild(
								document.createTextNode(yvar));
					}
					var ols = new iiiiliiill(x, y);
					ols.lliilllli();
					ols.iiiiilllll();
					var b     = ols.illii;
					var bse   = ols.lliilllii;
					var tstat = ols.llililllii;
					var pval  = ols.iiiiilllli;
					for (var j = 0; j < xvars.length; j++) {
						addRow("modelsummary", [xvars[j], b[j], bse[j], tstat[j], pval[j]], [0,8,8,3,3]);
					}
				}
				catch (err) {
					console.log(err.message);
					return;
				}
			});
	</script>

  </body>

</html>
